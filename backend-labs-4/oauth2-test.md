# OAuth 2.0 –ü–æ—Ç–æ–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó ‚Äî –¢–µ—Å—Ç–æ–≤—ñ —Å—Ü–µ–Ω–∞—Ä—ñ—ó —á–µ—Ä–µ–∑ OpenAPI Client

## –¢–µ—Å—Ç–æ–≤—ñ —Å—Ü–µ–Ω–∞—Ä—ñ—ó

–ù–∞ –ø–æ—á–∞—Ç–∫—É —Ä–æ–±–æ—Ç–∏ –Ω–µ–±—Ö—ñ–¥–Ω–æ –Ω–∞—Ç–∏—Å–Ω—É—Ç–∏ –Ω–∞ **üîìAutorize**

![1.png](assets%2F1.png)

–î–∞–ª—ñ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –æ–±—Ä–∞—Ç–∏ –æ–¥–∏–Ω –∑ —á–æ—Ç–∏—Ä—å—Ö –≤–∞—Ä—ñ–∞–Ω—Ç—ñ–≤ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó:

- Authorization Code Flow
- Implicit Flow
- Password Credentials Flow
- Client Credentials Flow

____________________________________________________________

### Authorization Code Flow

–ö–æ–ª–∏ –æ–±—Ä–∞–Ω–æ Authorization Code Flow –∑–∞–ø–æ–≤–Ω—é—î–º–æ –ø–æ–ª—è:

- client_id: auth-test
- client_secret: auth-test -> Credentials -> Client Secret
- openid: true

____________________________________________________________

![2.png](assets%2F2.png)

–ù–∞—Ç–∏—Å–∫–∞—î–º–æ **Authorize**, –≤–≤–æ–¥–∏–º–æ username/email —Ç–∞ password –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞:

![3.png](assets%2F3.png)

–û—Ç—Ä–∏–º–∞—î–º–æ:

![4.png](assets%2F4.png)

–£ –≤—ñ–¥–ø–æ–≤—ñ–¥—å –Ω–∞ GET-–∑–∞–ø–∏—Ç –ø–æ–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è –∫–æ–¥ 200 —Ç–∞ —Ç—ñ–ª–æ —É —Ñ–æ—Ä–º–∞—Ç—ñ JSON:

![5.png](assets%2F5.png)

____________________________________________________________

### Implicit Flow

–ö–æ–ª–∏ –æ–±—Ä–∞–Ω–æ Implicit Flow –∑–∞–ø–æ–≤–Ω—é—î–º–æ –ø–æ–ª—è:

- client_id: auth-test
- openid: true

____________________________________________________________

![6.png](assets%2F6.png)

–ù–∞—Ç–∏—Å–∫–∞—î–º–æ **Authorize**, –∞–Ω–∞–ª–æ–≥—ñ—á–Ω–æ –¥–æ Authorization Code Flow –≤–≤–æ–¥–∏–º–æ username/email —Ç–∞ password –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞

–û—Ç—Ä–∏–º–∞—î–º–æ:

![7.png](assets%2F7.png)

–£ –≤—ñ–¥–ø–æ–≤—ñ–¥—å –Ω–∞ GET-–∑–∞–ø–∏—Ç –ø–æ–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è –∫–æ–¥ 200 —Ç–∞ —Ç—ñ–ª–æ —É —Ñ–æ—Ä–º–∞—Ç—ñ JSON, —è–∫ —ñ —É Authorization Code Flow

____________________________________________________________

### Password Credentials Flow

–ö–æ–ª–∏ –æ–±—Ä–∞–Ω–æ Password Credentials Flow –∑–∞–ø–æ–≤–Ω—é—î–º–æ –ø–æ–ª—è:

- username: test_user
- password: ********
- client_id: auth-test
- client_secret: auth-test -> Credentials -> Client Secret
- openid: true

____________________________________________________________

![8.png](assets%2F8.png)

–ù–∞—Ç–∏—Å–∫–∞—î–º–æ **Authorize** —Ç–∞ –æ—Ç—Ä–∏–º–∞—î–º–æ:

![9.png](assets%2F9.png)

–£ –≤—ñ–¥–ø–æ–≤—ñ–¥—å –Ω–∞ GET-–∑–∞–ø–∏—Ç –ø–æ–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è –∫–æ–¥ 200 —Ç–∞ —Ç—ñ–ª–æ —É —Ñ–æ—Ä–º–∞—Ç—ñ JSON, —è–∫ —ñ —É –º–∏–Ω—É–ª–∏—Ö –ø–æ—Ç–æ–∫–∞—Ö –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó

____________________________________________________________

### Client Credentials Flow

–ö–æ–ª–∏ –æ–±—Ä–∞–Ω–æ Client Credentials Flow –∑–∞–ø–æ–≤–Ω—é—î–º–æ –ø–æ–ª—è:

- client_id: auth-test
- client_secret: auth-test -> Credentials -> Client Secret
- openid: true

____________________________________________________________

![10.png](assets%2F10.png)

–ù–∞—Ç–∏—Å–∫–∞—î–º–æ **Authorize** —Ç–∞ –æ—Ç—Ä–∏–º–∞—î–º–æ:

![11.png](assets%2F11.png)

–£ –≤—ñ–¥–ø–æ–≤—ñ–¥—å –Ω–∞ GET-–∑–∞–ø–∏—Ç –ø–æ–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è –∫–æ–¥ 200 —Ç–∞ —Ç—ñ–ª–æ —É —Ñ–æ—Ä–º–∞—Ç—ñ JSON, —è–∫–µ –≤—ñ–¥—Ä—ñ–∑–Ω—è—î—Ç—å—Å—è –≤—ñ–¥ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ —É –º–∏–Ω—É–ª–∏—Ö –ø–æ—Ç–æ–∫–∞—Ö –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó:

![12.png](assets%2F12.png)

____________________________________________________________

## –†–æ–∑'—è—Å–Ω–µ–Ω–Ω—è —â–æ–¥–æ –≤—ñ–¥–º—ñ–Ω–Ω–æ—Å—Ç–µ–π –ø—Ä–∏ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó —Ç–µ—Å—Ç–æ–≤–∏—Ö —Å—Ü–µ–Ω–∞—Ä—ñ—ó–≤

### 1. –ß–æ–º—É –ø—Ä–∏ Authorization Code Flow —Ç–∞ Implicit Flow Keycloak –ø—Ä–æ—Å–∏—Ç—å –≤–≤–µ—Å—Ç–∏ username/email —Ç–∞ password, –∞ –ø—Ä–∏ Password Credentials Flow —Ç–∞ Client Credentials Flow ‚Äî –Ω—ñ?

#### Authorization Code Flow —Ç–∞ Implicit Flow

–¶—ñ –ø–æ—Ç–æ–∫–∏ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω—ñ –¥–ª—è —ñ–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—ó –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞. –¢–æ–±—Ç–æ:

- –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –º–∞—î –ø–æ–±–∞—á–∏—Ç–∏ —Ñ–æ—Ä–º—É –ª–æ–≥—ñ–Ω—É (–≤–≤–æ–¥–∏—Ç—å email/username —ñ –ø–∞—Ä–æ–ª—å).
- Keycloak –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—î –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –Ω–∞ –µ–∫—Ä–∞–Ω –≤—Ö–æ–¥—É, –±–æ —Ü–µ —á–∞—Å—Ç–∏–Ω–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ–π–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—É —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä.
- –ú–µ—Ç–∞ ‚Äî –¥–æ–∑–≤–æ–ª–∏—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É –Ω–∞–¥–∞—Ç–∏ –∑–≥–æ–¥—É –Ω–∞ –¥–æ—Å—Ç—É–ø (—á–µ—Ä–µ–∑ UI).

üîÑ –ë—Ä–∞—É–∑–µ—Ä ‚Üí Keycloak ‚Üí –ª–æ–≥—ñ–Ω ‚Üí —Ä–µ–¥—ñ—Ä–µ–∫—Ç –∑ –∫–æ–¥–æ–º / —Ç–æ–∫–µ–Ω–æ–º

#### Password Credentials Flow

–£ —Ü—å–æ–º—É –ø–æ—Ç–æ—Ü—ñ –ª–æ–≥—ñ–Ω —ñ –ø–∞—Ä–æ–ª—å –≤–≤–æ–¥—è—Ç—å—Å—è –Ω–∞–ø—Ä—è–º—É –≤ –∫–ª—ñ—î–Ω—Ç—ñ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —É Postman —á–∏ —á–µ—Ä–µ–∑ OpenAPI UI).

- –¢—É—Ç –≤–∑–∞—î–º–æ–¥—ñ—ó –∑ UI Keycloak –Ω–µ–º–∞.
- –í–∏ –ø–µ—Ä–µ–¥–∞—î—Ç–µ –ª–æ–≥—ñ–Ω —ñ –ø–∞—Ä–æ–ª—å –Ω–∞–ø—Ä—è–º—É –≤ POST-–∑–∞–ø–∏—Ç—ñ –Ω–∞ tokenUrl.
- Keycloak –Ω–µ –∑–∞–ø–∏—Ç—É—î –Ω—ñ—á–æ–≥–æ –¥–æ–¥–∞—Ç–∫–æ–≤–æ, –±–æ –≤—Å—è –ø–æ—Ç—Ä—ñ–±–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –≤–∂–µ —î.

–¶–µ–π –ø–æ—Ç—ñ–∫ –≤–≤–∞–∂–∞—î—Ç—å—Å—è –º–µ–Ω—à –±–µ–∑–ø–µ—á–Ω–∏–º —ñ –ø—ñ–¥—Ö–æ–¥–∏—Ç—å –ª–∏—à–µ –¥–ª—è –¥–æ–≤—ñ—Ä–µ–Ω–∏—Ö –∫–ª—ñ—î–Ω—Ç—ñ–≤ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, CLI –∞–±–æ –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ—Ö —Å–µ—Ä–≤—ñ—Å—ñ–≤).

#### Client Credentials Flow

–¶–µ –º–∞—à–∏–Ω–∞-–¥–æ-–º–∞—à–∏–Ω–∏ (M2M) –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è ‚Äî –∂–æ–¥–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –Ω–µ —ñ—Å–Ω—É—î –≤ —Ü—å–æ–º—É –ø—Ä–æ—Ü–µ—Å—ñ.

- –ü—Ä–æ—Ü–µ—Å –ª–æ–≥—ñ–Ω—É –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –≤—ñ–¥ —ñ–º–µ–Ω—ñ –∫–ª—ñ—î–Ω—Ç–∞, –∞ –Ω–µ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞.
- –ñ–æ–¥–Ω–æ–≥–æ –ª–æ–≥—ñ–Ω—É —á–∏ –≤–∑–∞—î–º–æ–¥—ñ—ó –∑ UI Keycloak –Ω–µ–º–∞—î, –±–æ –Ω–µ–º–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, —è–∫–æ–≥–æ –ª–æ–≥—ñ–Ω–∏—Ç–∏.
- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –ª–∏—à–µ —á–µ—Ä–µ–∑ client_id + client_secret.

### 2. –ß–æ–º—É —Ç—ñ–ª–æ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –ø—Ä–∏ Client Credentials Flow —ñ–Ω—à–µ, –Ω—ñ–∂ —É —ñ–Ω—à–∏—Ö –ø–æ—Ç–æ–∫–∞—Ö?

#### Authorization Code / Implicit / Password Flows:

- –í–∏–¥–∞—é—Ç—å —Ç–æ–∫–µ–Ω –≤—ñ–¥ —ñ–º–µ–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞.
- –í—ñ–¥–ø–æ–≤—ñ–¥—å –Ω–∞ /userinfo –º—ñ—Å—Ç–∏—Ç—å –ø—Ä–æ—Ñ—ñ–ª—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞: —ñ–º'—è, email, username, —Ç–æ—â–æ.

#### Client Credentials Flow

–ù–µ–º–∞—î –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, —Ç–æ–º—É –≤—ñ–¥–ø–æ–≤—ñ–¥—å –º—ñ—Å—Ç–∏—Ç—å —Ç–µ—Ö–Ω—ñ—á–Ω–∏–π –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å:

- preferred_username: service-account-<client_id>
- email: –≤—ñ–¥—Å—É—Ç–Ω—ñ–π
- name: –≤—ñ–¥—Å—É—Ç–Ω—î
- email_verified: false, –±–æ —Ü–µ –Ω–µ –ª—é–¥–∏–Ω–∞

____________________________________________________________

## –í–∏—Å–Ω–æ–≤–∫–∏

| –ü–æ—Ç—ñ–∫                   | –•—Ç–æ –∞–≤—Ç–æ—Ä–∏–∑—É—î—Ç—å—Å—è           | –í–≤–µ–¥–µ–Ω–Ω—è –ª–æ–≥—ñ–Ω—É/–ø–∞—Ä–æ–ª—è | –¢–∏–ø –ø—Ä–æ—Ñ—ñ–ª—é —É –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ    |
| ----------------------- | --------------------------- | ---------------------- | -------------------------- |
| Authorization Code Flow | –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä    | –¢–∞–∫                    | –ü–æ–≤–Ω–∏–π –ø—Ä–æ—Ñ—ñ–ª—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ |
| Implicit Flow           | –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä    | –¢–∞–∫                    | –ü–æ–≤–Ω–∏–π –ø—Ä–æ—Ñ—ñ–ª—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ |
| Password Credentials    | –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω–∞–ø—Ä—è–º—É          | –ù—ñ (–≤ API)             | –ü–æ–≤–Ω–∏–π –ø—Ä–æ—Ñ—ñ–ª—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ |
| Client Credentials      | –°–µ—Ä–≤—ñ—Å (machine-to-machine) | –ù—ñ                     | Service account –ø—Ä–æ—Ñ—ñ–ª—å    |